<html>
	<head>
		<title>My first three.js app</title>
		<style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
		</style>
        <!-- <script src="node_modules/three/examples/jsm/AxisHelper.js"></script> -->
        <!-- <script src="node_modules/three/examples/jsm/GridHelper.js"></script> -->
        <script src="js/three.js"></script>
        <!-- <script type="module" src="js/OrbitControls.js"></script> -->
	</head>
	<body>
        <script>window.THREE = THREE || {};</script>
        <script type="module" src="node_modules/three-orbitcontrols/OrbitControls.js"></script>
		<script>
            setTimeout(function() {
                function onDocumentMouseDown(event) {
                    event.preventDefault();
                    switch (event.which) {
                        case 1: // left mouse click
                            mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
                            mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;
                            mouse.unproject( camera );

                            // projector.unproject(vector, camera);

                            var ray = new THREE.Raycaster(camera.position, 
                                                    mouse.sub(camera.position).normalize());

                            var intersects = ray.intersectObjects(scene.children);

                            if (intersects.length > 0) {
                                intersects[0].object.materials[0].color.setHex(Math.random() * 0xffffff);
                                var particle = new THREE.Particle(particleMaterial);
                                particle.position = intersects[0].point;
                                particle.scale.x = particle.scale.y = 8;
                                scene.add(particle);

                                console.log(mouse);
                            }
                            break;
                        
                        default:
                            break;
                    }
                    
                }


                var scene = new THREE.Scene();
                var mouse = new THREE.Vector3( 0, 0, 0.5 );
                var renderer = new THREE.WebGLRenderer({ antialias: true });
                renderer.setSize( window.innerWidth, window.innerHeight );
                document.body.appendChild( renderer.domElement );

                // Camera
                var camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 0.1, 1000 );
                // var projector = new THREE.Projector();
                var orbit = new THREE.OrbitControls( camera, renderer.domElement );
                orbit.enableZoom = true;
                orbit.enableRotate = false;

                // Event handlers
                document.addEventListener('mousedown', onDocumentMouseDown, false);


                // CUBE
                var geometry = new THREE.BoxGeometry( 1, 1, 1 );
                var material = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );
                var cube = new THREE.Mesh( geometry, material );

                // CUBE LINES
                var lineMaterial = new THREE.LineBasicMaterial({color: 0x000000, transparent: true, opacity: 1.0});
                var lines = new THREE.LineSegments( geometry, lineMaterial )

                // SPHERE
                var sphereGeometry = new THREE.SphereGeometry( 1, 32, 32 );
                var sphereMaterial = new THREE.MeshBasicMaterial( {color: 0xffff00, transparent: true, opacity: 0.2} );
                var sphere = new THREE.Mesh( sphereGeometry, sphereMaterial );

                // Building the scene
                scene.add(cube);
                scene.add(lines);
                scene.add(sphere);
                camera.position.z = 5;

                var animate = function () {
                    requestAnimationFrame( animate );



                    // cube.rotation.x += 0.01;
                    // cube.rotation.x += 0.01;
                    // lines.rotation.y += 0.01;
                    // lines.rotation.y += 0.01;

                    renderer.render(scene, camera);
                };

                console.log(scene);

                animate();
            }, 10);
		</script>
	</body>
</html>